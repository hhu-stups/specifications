IMPLEMENTATION   bibliotheque_iREFINES   bibliothequeCONCRETE_CONSTANTS   abonne_indetermine,   livre_indeterminePROPERTIES   abonne_indetermine : NAT &   livre_indetermine : NAT &   abonne_indetermine /: Ens_abonnes &   livre_indetermine /: Ens_livres &   abonne_indetermine = 1000 + 1 &   livre_indetermine = 5000 + 1VALUES   Ens_abonnes = 0..1000 ;   Ens_exemplaires = 0..10000 ;   Ens_livres = 0..5000 ;   abonne_indetermine = 1000 + 1 ;   livre_indetermine = 5000 + 1CONCRETE_VARIABLES   tableau_abonnes,   tableau_exemplaires,   tableau_livres,   tableau_est_emprunte_par,   tableau_est_exemplaire_deINVARIANT   tableau_abonnes : Ens_abonnes --> BOOL &   tableau_exemplaires : Ens_exemplaires --> BOOL &   tableau_livres : Ens_livres --> BOOL &   tableau_est_emprunte_par : Ens_exemplaires --> 0..(1000 + 1) &   tableau_est_exemplaire_de : Ens_exemplaires --> 0..(5000 + 1) &   est_emprunte_par =      tableau_est_emprunte_par |>> {abonne_indetermine} &   est_exemplaire_de =      tableau_est_exemplaire_de |>> {livre_indetermine} &   Abonnes = dom (tableau_abonnes |> {TRUE}) &   Exemplaires = dom (tableau_exemplaires |> {TRUE}) &   Livres = dom (tableau_livres |> {TRUE})INITIALISATION   tableau_abonnes := Ens_abonnes * {FALSE} ;   tableau_exemplaires := Ens_exemplaires * {FALSE} ;   tableau_livres := Ens_livres * {FALSE} ;   tableau_est_exemplaire_de := Ens_exemplaires * {livre_indetermine} ;   tableau_est_emprunte_par := Ens_exemplaires * {abonne_indetermine}OPERATIONS   ajouter_abonne (abonne) =      tableau_abonnes (abonne) := TRUE ;   supprimer_abonne (abonne) =      tableau_abonnes (abonne) := FALSE ;   ajouter_livre (livre) =      tableau_livres (livre) := TRUE ;   supprimer_livre (livre) =      tableau_livres (livre) := FALSE ;   supprimer_exemplaire (exemplaire) =      BEGIN         tableau_exemplaires (exemplaire) := FALSE ;         tableau_est_exemplaire_de (exemplaire) := livre_indetermine      END ;   ex <--   ajouter_exemplaire (livre) =      VAR         exemplaire, index_boucle, valeur_boucle      IN         /* on doit tout d'abord trouver l'exemplaire           * avant de modifier nos relations */         index_boucle := 10000 ;         valeur_boucle := tableau_est_exemplaire_de (index_boucle) ;         WHILE            index_boucle > 0 &            valeur_boucle /= livre_indetermine         DO            index_boucle := index_boucle - 1 ;            valeur_boucle := tableau_est_exemplaire_de (index_boucle)         INVARIANT            index_boucle : 0..10000 &            ran (tableau_est_exemplaire_de) <: NAT &            valeur_boucle : Ens_livres \/ {livre_indetermine} &            valeur_boucle = tableau_est_exemplaire_de (index_boucle) &            ((index_boucle + 1)..10000 <| tableau_est_exemplaire_de)             |> {livre_indetermine} = {}         VARIANT            index_boucle         END ;         exemplaire := index_boucle ;         tableau_est_exemplaire_de (exemplaire) := livre ;         tableau_exemplaires (exemplaire) := TRUE ;         ex := exemplaire      END ;   emprunter_exemplaire (exemplaire, abonne) =      tableau_est_emprunte_par (exemplaire) := abonne ;   rendre_exemplaire (exemplaire) =      tableau_est_emprunte_par (exemplaire) := abonne_indetermineEND